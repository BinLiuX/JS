<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		.ball {
			width: 40px;
			height: 40px;
			border-radius: 20px;
		}
		.ball1 {
			background: #540A0A;
		}
		.ball2 {
			background: #F45A5A;
		}
		.ball3 {
			background: #393636;
		}
	</style>
</head>
<body>
	<div style="margin-left: 0" class="ball ball1"></div>
	<div style="margin-left: 0" class="ball ball2"></div>
	<div style="margin-left: 0" class="ball ball3"></div>
	<script>
		var ball1 = document.querySelector('.ball1');
		var ball2 = document.querySelector('.ball2');
		var ball3 = document.querySelector('.ball3');
		function animate(ball,distance,callback) {
			setTimeout(function () {
				var dis = ball.style.marginLeft;
				var marginLeft = parseInt(dis,10);
				if (marginLeft === distance) {
					callback();
				} else {
					if (marginLeft < distance) {
						marginLeft++;
					} else {
						marginLeft--;
					}

					ball.style.marginLeft = marginLeft + 'px';
					animate(ball,distance,callback);
				}
			},13);
		}

		animate(ball1,100,function () {
			animate(ball2,200,function () {
				animate(ball3,300,function () {
					animate(ball3,150,function () {
						animate(ball2,150,function () {
							animate(ball1,150,function () {
								//callback hell
							});
						});
					});
				});
			});
		});
		
		
		
		//promise的使用
		// var  Promise = window.Promise;

		// function promiseAnimate(ball,distance) {

		// 	return new Promise(function (resolve,reject) {
				
		// 		function _animate(ball,distance) {
		// 			setTimeout(function () {
		// 				var marginLeft = parseInt(ball.style.marginLeft,10);
		// 				if (marginLeft === distance) {
		// 					resolve();
		// 				} else {
		// 					if (marginLeft < distance) {
		// 						marginLeft++;
		// 					} else {
		// 						marginLeft--;
		// 					};

		// 					ball.style.marginLeft = marginLeft + 'px';
		// 					_animate(ball,distance);
		// 				};
		// 			},13);
		// 		};
		// 		_animate(ball,distance);		
		// 	});
		// };

		// promiseAnimate(ball1,100)
		// 	.then(function () {
		// 		return promiseAnimate(ball2,200);
		// 	})
		// 	.then(function () {
		// 		return promiseAnimate(ball3,300);
		// 	})
		// 	.then(function () {
		// 		return promiseAnimate(ball3,150);
		// 	})
		// 	.then(function () {
		// 		return promiseAnimate(ball2,150);
		// 	})
		// 	.then(function () {
		// 		return promiseAnimate(ball1,150);
		// 	});
	</script>
</body>
</html>